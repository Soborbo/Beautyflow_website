---
import { Image } from 'astro:assets';
import Layout from '../layouts/Layout.astro';
import LocationsSection from '../components/LocationsSection.astro';
import { type Locale, defaultLang, getLocalizedPath } from '../i18n';

interface Props {
  lang?: Locale;
}

const { lang = defaultLang } = Astro.props;

// Image imports
import beautyflowDijak from '../assets/images/beautyflow-dijak.webp';
import konyaFanniSq from '../assets/images/Konya-Fanni-sq.jpg';
import fodorInez from '../assets/images/fodor-inez.jpg';
import nagyPiroska from '../assets/images/Nagy-Piroska.jpg';
import desvariLiliRozi from '../assets/images/Desvari-Lili-Rozi.jpg';
import trexlerJanka from '../assets/images/trexler-janka-kozmetikus.jpg';
import vargaAndrea from '../assets/images/Varga-Andrea.jpg';
import barnaNiki from '../assets/images/Barna-niki-beautyflow.jpg';

const organizationSchema = {
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Beautyflow Szépségszalon",
  "url": "https://beautyflow.pro",
  "logo": "https://beautyflow.pro/images/Beautyflow-favicon.png",
  "description": "Többszörösen díjnyertes szépségszalon Budapesten. Lézeres szőrtelenítés, sminktetoválás, arckezelések.",
  "foundingDate": "2014",
  "founder": {
    "@type": "Person",
    "name": "Kónya Fanni"
  },
  "numberOfEmployees": "7",
  "address": [
    {
      "@type": "PostalAddress",
      "streetAddress": "Vegyész utca 1.",
      "addressLocality": "Budapest",
      "postalCode": "1116",
      "addressCountry": "HU"
    },
    {
      "@type": "PostalAddress",
      "streetAddress": "Reitter Ferenc utca 90.",
      "addressLocality": "Budapest",
      "postalCode": "1135",
      "addressCountry": "HU"
    }
  ],
  "contactPoint": {
    "@type": "ContactPoint",
    "telephone": "+36 1 300 9414",
    "contactType": "customer service",
    "availableLanguage": "Hungarian"
  },
  "sameAs": [
    "https://www.instagram.com/beautyflow.pro/",
    "https://www.facebook.com/beautyflow.pro/"
  ]
};

// BreadcrumbList Schema
const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Főoldal",
      "item": "https://beautyflow.pro"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Rólunk",
      "item": "https://beautyflow.pro/rolunk"
    }
  ]
};

const milestones = [
  { year: '2015 február', event: 'Elkezdődik Fanni útja a szépségiparban' },
  { year: '2017 október', event: 'Első sminktetováló képzés elvégzése' },
  { year: '2018 február', event: 'Kitűnő eredménnyel végzett szépségtanácsadó (OKJ)' },
  { year: '2019 augusztus', event: 'Szemöldök stylist és műszempilla oktató lettem, a megszerzett tudást a sminktetoválások során azóta is aktívan alkalmazom' },
  { year: '2020 január', event: 'Kozmetikussá váltam kitüntetett 5-ös eredménnyel, 100%-os vizsgával, valamint Gáspár Melindánál tanulhattam sminktetoválás eltávolítást' },
  { year: '2021', event: 'A covid időszak alatt kizárólag tanulásra fókuszáltam: Méhn Tünde PMU ART School ajak- és szemhéj sminktetoválás képzés, valamint cukorpasztás depiláció' },
  { year: '2022', event: 'Megvásároltam az első elektrokozmetikai gépemet, a diódalézeres szőrtelenítő készüléket' },
  { year: '2023', event: 'Második diódalézeres szőrtelenítő gép beszerzése, tudatos elindulás az elektrokozmetika irányába' },
  { year: '2024', event: 'Megnyílik a Beautyflow Buda' },
  { year: '2024', event: 'Év Vállalkozója díj', isAward: true },
  { year: '2024', event: 'Notino Partner lettem', isAward: true },
  { year: '2025 március', event: 'Hónap Szalonja díj', isAward: true },
  { year: '2025', event: 'Év Vállalkozója díj', isAward: true },
  { year: '2025', event: 'Bővülünk Nd:YAG lézerrel és HydraBeauty géppel' },
  { year: '2026', event: 'Új szolgáltatások: BioPen Q2, tengeri algás hámlasztó eljárás, gyémántfejes bőrcsiszoló dermabráziós kezelés, elektrolízises szőrtelenítés' }
];

const teamMembers = [
  {
    name: 'Kónya Fanni',
    role: 'Tulajdonos, Vezető kozmetikus',
    image: konyaFanniSq,
    description: 'A Beautyflow alapítója és lelke. Fanni több mint 10 éves tapasztalattal rendelkezik a szépségiparban, és szinte minden kezelést végez a szalonban. A telefonos konzultációkat is ő intézi – ha kérdésed van, nyugodtan hívj!',
    treatments: [
      { name: 'Diódalézeres szőrtelenítés', url: '/dioda-lezeres-szortelenites' },
      { name: 'Sminktetoválás', url: '/sminktetovalas' },
      { name: 'Tetoválás eltávolítás', url: '/lezeres-tetovalas-eltavolitas' },
      { name: 'Pigmentfolt eltávolítás', url: '/pigmentfolt-eltavolitas' },
      { name: 'Hydrabeauty', url: '/hydrabeauty' },
      { name: 'Carbon Peeling', url: '/carbon-peeling' }
    ]
  },
  {
    name: 'Fodor Inez Vivien',
    role: 'Kozmetikus',
    image: fodorInez,
    description: 'A részletekre figyelek, nem az órára. Évek óta diódalézeres szőrtelenítéssel foglalkozom, és egy dolgot tanultam meg biztosan: a jó eredményhez idő kell. Nálam nincs kapkodás, nincs "gyorsan letudni" mentalitás. Minden kezelést a te bőrödre szabok – legyen szó lézerről, Hydrabeauty-ról vagy carbon peelingről.',
    treatments: [
      { name: 'Diódalézeres szőrtelenítés', url: '/dioda-lezeres-szortelenites' },
      { name: 'Hydrabeauty', url: '/hydrabeauty' },
      { name: 'Carbon Peeling', url: '/carbon-peeling' }
    ]
  },
  {
    name: 'Nagy Piroska',
    role: 'Kozmetikus',
    image: nagyPiroska,
    description: '2016 óta kozmetikus. A precizitás nálam nem opció – alap. Gyöngyösön kezdtem, Budapesten folytattam. Több város, több szalon, több ezer kezelés – és mindegyikből tanultam valamit. Jelenleg a diódalézeres szőrtelenítésre specializálódtam. A kezelés alatt szeretek beszélgetni, nevetni, lazítani. De amikor dolgozom, a kezem nem viccel.',
    treatments: [
      { name: 'Diódalézeres szőrtelenítés', url: '/dioda-lezeres-szortelenites' }
    ]
  },
  {
    name: 'Désvári Lili Rozi',
    role: 'Kozmetikus',
    image: desvariLiliRozi,
    description: 'Vasárnaponként Budán várlak – és folyamatosan fejlődve. A Beautyflow csapat tagjaként rendszeresen képzem magam, mert a szépségipar nem áll meg, és én sem akarok. Diódalézeres szőrtelenítést, Hydrabeauty-t és carbon peelinget kínálok – mindig a legfrissebb tudással.',
    treatments: [
      { name: 'Diódalézeres szőrtelenítés', url: '/dioda-lezeres-szortelenites' },
      { name: 'Hydrabeauty', url: '/hydrabeauty' },
      { name: 'Carbon Peeling', url: '/carbon-peeling' }
    ]
  },
  {
    name: 'Trexler Janka',
    role: 'Kozmetikus',
    image: trexlerJanka,
    description: 'A Sisiben tanultam a szakmát. A jó hangulatot magamtól hoztam. Kozmetikusnak lenni számomra azt jelenti, hogy segíthetek. Nem csak a bőrödön, hanem azon is, hogy egy kicsit feltöltődj a mindennapokból. Carbon peeling, Hydrabeauty, diódalézeres szőrtelenítés – bármelyiket választod, egy biztos: mosollyal fogsz távozni.',
    treatments: [
      { name: 'Diódalézeres szőrtelenítés', url: '/dioda-lezeres-szortelenites' },
      { name: 'Hydrabeauty', url: '/hydrabeauty' },
      { name: 'Carbon Peeling', url: '/carbon-peeling' }
    ]
  },
  {
    name: 'Varga Andrea',
    role: 'Kozmetikus, Sminktetováló',
    image: vargaAndrea,
    description: 'Kozmetikus és sminktetováló – a részletekben hiszek. Évek óta dolgozom a szépségiparban, és egy dolog nem változott: minden vendéget egyénileg kezelek. Szó szerint. Carbon peeling, lézer, Hydrabeauty, pigmentfolt eltávolítás vagy éppen sminktetoválás eltávolítás – mindig az adott bőrhöz és igényhez igazítom a kezelést.',
    treatments: [
      { name: 'Carbon Peeling', url: '/carbon-peeling' },
      { name: 'Diódalézeres szőrtelenítés', url: '/dioda-lezeres-szortelenites' },
      { name: 'Hydrabeauty', url: '/hydrabeauty' },
      { name: 'Pigmentfolt eltávolítás', url: '/pigmentfolt-eltavolitas' },
      { name: 'Sminktetoválás eltávolítás', url: '/lezeres-tetovalas-eltavolitas' }
    ]
  },
  {
    name: 'Niki',
    role: 'Kozmetikus',
    image: barnaNiki,
    description: 'A csapat legújabb tagja vagyok – de a lelkesedésben nem maradok le. Diódalézeres szőrtelenítéssel és carbon peelinggel foglalkozom, és imádok beszélgetni közben. Nálam gyorsan telik az idő, mert nem csak kezelés van, hanem kapcsolat is. Ha kicsit izgulsz az első alkalom előtt, ne tedd. Közvetlen vagyok, figyelek rád.',
    treatments: [
      { name: 'Diódalézeres szőrtelenítés', url: '/dioda-lezeres-szortelenites' },
      { name: 'Carbon Peeling', url: '/carbon-peeling' }
    ]
  }
];

const values = {
  hu: [
    {
      icon: 'heart',
      title: 'Törődés',
      description: 'Minden vendégünket egyedi figyelemmel és törődéssel kezeljük. Nálunk nem csak egy szám vagy egy időpont vagy.'
    },
    {
      icon: 'star',
      title: 'Minőség',
      description: 'Csak a legjobb eszközökkel és termékekkel dolgozunk. Folyamatosan képezzük magunkat, hogy a legmodernebb technikákat alkalmazhassuk.'
    },
    {
      icon: 'shield',
      title: 'Biztonság',
      description: 'Minden higiéniai elvárásnak megfelelünk, és mindent megteszünk azért, hogy biztonságban érezd magad.'
    }
  ],
  en: [
    {
      icon: 'heart',
      title: 'Care',
      description: "We treat every guest with individual attention and care. You're not just a number or an appointment here."
    },
    {
      icon: 'star',
      title: 'Quality',
      description: 'We only work with the best equipment and products. We continuously train ourselves to apply the most modern techniques.'
    },
    {
      icon: 'shield',
      title: 'Safety',
      description: 'We meet all hygiene standards and do everything to make you feel safe.'
    }
  ]
};

const content = {
  hu: {
    pageTitle: 'Rólunk - Beautyflow Szépségszalon Budapest',
    pageDescription: 'Ismerd meg a Beautyflow történetét, csapatát és értékeit. Többszörösen díjnyertes szépségszalon Budapesten, ahol a vendég mindig az első.',
    heroTitle: 'A Beautyflow csapata',
    heroSubtitle: 'Ismerd meg a szakembereket, akik gondoskodnak rólad! Csapatunk elkötelezett a minőség és a személyre szabott szolgáltatás iránt.',
    storyTitle: 'A történetünk',
    storyP1: 'A Beautyflow-t 2014-ben alapította Kónya Fanni, azzal a céllal, hogy egy olyan szépségszalont hozzon létre, ahol minden vendég valódi törődést és professzionális szolgáltatást kap.',
    storyP2: 'Az évek során két modern szalonná bővültünk - egyet Budán, egyet Pesten - és ma már 7 fős csapattal dolgozunk. A Notino "Hónap Szépségszalonja" díjat is elnyertük, ami visszaigazolja munkánk minőségét.',
    storyP3: 'Hitvallásunk egyszerű: minden vendég egyedi, és megérdemli a legjobb kezelést. Ezért szentelünk időt az ingyenes konzultációkra és a személyre szabott tanácsadásra.',
    storyImageAlt: 'Beautyflow - Notino Hónap Szalonja díj',
    milestonesTitle: 'Mérföldkövek',
    teamTitle: 'Ismerd meg csapatunkat',
    valuesTitle: 'Értékeink',
    ctaTitle: 'Ismerjük meg egymást személyesen!',
    ctaSubtitle: 'Gyere el egy ingyenes konzultációra és ismerd meg csapatunkat, mielőtt döntesz!',
    ctaButton: 'Ingyenes konzultációt kérek',
  },
  en: {
    pageTitle: 'About Us - Beautyflow Beauty Salon Budapest',
    pageDescription: 'Meet the Beautyflow team, our story and values. Award-winning beauty salon in Budapest where the guest always comes first.',
    heroTitle: 'The Beautyflow Team',
    heroSubtitle: 'Meet the professionals who take care of you! Our team is committed to quality and personalized service.',
    storyTitle: 'Our Story',
    storyP1: 'Beautyflow was founded in 2014 by Fanni Kónya, with the goal of creating a beauty salon where every guest receives genuine care and professional service.',
    storyP2: 'Over the years, we have grown into two modern salons - one in Buda, one in Pest - and now we work with a team of 7. We also won the Notino "Salon of the Month" award, which confirms the quality of our work.',
    storyP3: 'Our philosophy is simple: every guest is unique and deserves the best treatment. That is why we dedicate time to free consultations and personalized advice.',
    storyImageAlt: 'Beautyflow - Notino Salon of the Month award',
    milestonesTitle: 'Milestones',
    teamTitle: 'Meet Our Team',
    valuesTitle: 'Our Values',
    ctaTitle: "Let's meet in person!",
    ctaSubtitle: 'Come for a free consultation and meet our team before you decide!',
    ctaButton: 'Request Free Consultation',
  }
};

const t = content[lang];
const currentValues = values[lang];
const consultationPath = getLocalizedPath(lang === 'hu' ? '/ingyenes-konzultacio' : '/free-consultation', lang);
---

<Layout title={t.pageTitle} description={t.pageDescription} lang={lang}>
  <script type="application/ld+json" set:html={JSON.stringify(organizationSchema)} />
  <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />

  <!-- Hero Section -->
  <section class="py-16 lg:py-20 bg-gradient-to-br from-[#fdf8f6] via-[#fef5f2] to-[#fff9f7]">
    <div class="max-w-[1100px] mx-auto px-4 text-center">
      <h1 class="font-heading text-4xl lg:text-5xl text-gray-900 mb-4">
        {t.heroTitle}
      </h1>
      <p class="text-gray-600 max-w-2xl mx-auto">
        {t.heroSubtitle}
      </p>
    </div>
  </section>

  <!-- Our Story Section -->
  <section class="py-16 lg:py-20 bg-white">
    <div class="max-w-[1100px] mx-auto px-4">
      <div class="grid gap-10 lg:grid-cols-2 lg:gap-16 items-center">
        <div class="order-2 lg:order-1">
          <h2 class="font-heading text-3xl lg:text-4xl text-gray-900 mb-6">
            {t.storyTitle}
          </h2>
          <div class="space-y-4 text-gray-600">
            <p>{t.storyP1}</p>
            <p>{t.storyP2}</p>
            <p>{t.storyP3}</p>
          </div>
        </div>
        <div class="order-1 lg:order-2">
          <Image
            src={beautyflowDijak}
            alt={t.storyImageAlt}
            class="w-full rounded-2xl shadow-lg"
            format="webp"
            quality={80}
            loading="eager"
            fetchpriority="high"
          />
        </div>
      </div>
    </div>
  </section>

  <!-- Timeline Section - Parallax Horizontal Scroll -->
  <section class="timeline-section bg-gradient-to-b from-[#fdf8f6] to-white">
    <div class="timeline-sticky-container">
      <div class="max-w-[1100px] mx-auto px-4 py-16 lg:py-20">
        <div class="text-center mb-12">
          <h2 class="font-heading text-3xl lg:text-4xl text-gray-900">
            {t.milestonesTitle}
          </h2>
        </div>

        <!-- Horizontal timeline with parallax -->
        <div class="overflow-hidden">
          <div class="timeline-track flex gap-4">
            {milestones.map((milestone, index) => (
              <div class="timeline-item flex flex-col items-center min-w-[200px] relative flex-shrink-0">
                <!-- Year circle - gold for awards, pink for regular -->
                <div class={`w-20 h-20 rounded-full flex items-center justify-center text-white font-heading text-base font-semibold shadow-lg z-10 ${milestone.isAward ? 'bg-gradient-to-br from-yellow-400 to-yellow-600' : 'bg-[#c53f75]'}`}>
                  {milestone.isAward && (
                    <svg class="w-5 h-5 absolute -top-1 -right-1 text-yellow-400 drop-shadow" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                    </svg>
                  )}
                  <span class="text-center leading-tight px-1">{milestone.year}</span>
                </div>

                <!-- Connecting line -->
                {index < milestones.length - 1 && (
                  <div class="absolute top-10 left-[calc(50%+40px)] w-[calc(200px-40px)] h-0.5 bg-[#c53f75]/30"></div>
                )}

                <!-- Event card -->
                <div class={`mt-4 p-4 rounded-xl shadow-md text-center max-w-[180px] ${milestone.isAward ? 'bg-gradient-to-br from-yellow-50 to-yellow-100 border border-yellow-200' : 'bg-white'}`}>
                  {milestone.isAward && <span class="text-yellow-500 text-lg">⭐</span>}
                  <p class="text-gray-700 text-sm leading-relaxed">{milestone.event}</p>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Team Section -->
  <section class="py-16 lg:py-20 bg-gradient-to-br from-[#fdf8f6] via-[#fef5f2] to-[#fff9f7]">
    <div class="max-w-[1100px] mx-auto px-4">
      <div class="text-center mb-12">
        <h2 class="font-heading text-3xl lg:text-4xl text-gray-900 mb-4">
          {t.teamTitle}
        </h2>
      </div>

      <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        {teamMembers.map((member) => (
          <div class="bg-white border border-gray-100 rounded-xl overflow-hidden shadow-md hover:shadow-xl transition-shadow flex flex-col">
            <!-- Image or Initials -->
            <div class="flex justify-center pt-6">
              {member.image ? (
                <Image
                  src={member.image}
                  alt={member.name}
                  class="w-32 h-32 rounded-full object-cover shadow-md"
                  format="webp"
                  quality={80}
                  loading="lazy"
                  width={128}
                  height={128}
                />
              ) : (
                <div class="w-32 h-32 rounded-full bg-[#c53f75]/10 flex items-center justify-center shadow-md">
                  <span class="font-heading text-3xl text-[#c53f75]">{member.initials}</span>
                </div>
              )}
            </div>

            <!-- Content -->
            <div class="p-6 flex flex-col flex-1">
              <h3 class="font-heading text-xl text-gray-900 mb-1 text-center">{member.name}</h3>
              <p class="text-[#c53f75] text-sm font-medium mb-3 text-center">{member.role}</p>
              <p class="text-gray-600 text-sm mb-4 leading-relaxed flex-1 text-left">{member.description}</p>

              <!-- Treatments as buttons -->
              <div class="flex flex-wrap justify-center md:justify-start gap-2 mt-auto">
                {member.treatments.map((treatment) => (
                  <a
                    href={treatment.url}
                    class="inline-block px-4 py-2 text-xs text-[#c53f75] bg-[#c53f75]/10 rounded-full hover:bg-[#c53f75]/20 transition-colors"
                  >
                    {treatment.name}
                  </a>
                ))}
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Values Section -->
  <section class="py-16 lg:py-20 bg-gradient-to-b from-[#fdf8f6] to-white">
    <div class="max-w-[1100px] mx-auto px-4">
      <div class="text-center mb-12">
        <h2 class="font-heading text-3xl lg:text-4xl text-gray-900">
          {t.valuesTitle}
        </h2>
      </div>

      <div class="grid gap-8 md:grid-cols-3">
        {currentValues.map((value) => (
          <div class="text-center">
            <div class="w-16 h-16 mx-auto mb-4 bg-[#c53f75]/10 rounded-full flex items-center justify-center text-[#c53f75]">
              {value.icon === 'heart' && (
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                </svg>
              )}
              {value.icon === 'star' && (
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z" />
                </svg>
              )}
              {value.icon === 'shield' && (
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                </svg>
              )}
            </div>
            <h3 class="font-heading text-xl text-gray-900 mb-3">{value.title}</h3>
            <p class="text-gray-600 text-sm leading-relaxed max-w-xs mx-auto">{value.description}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="py-16 lg:py-20 bg-[#c53f75]">
    <div class="max-w-[900px] mx-auto px-4 text-center">
      <p class="font-heading text-3xl lg:text-4xl text-white mb-6">
        {t.ctaTitle}
      </p>
      <p class="text-white/80 mb-8 max-w-xl mx-auto">
        {t.ctaSubtitle}
      </p>
      <div class="flex justify-center">
        <a
          href={consultationPath}
          class="inline-block px-8 py-4 bg-white text-[#c53f75] font-bold uppercase text-sm rounded-full shadow-lg hover:bg-gray-100 transition-all"
        >
          {t.ctaButton}
        </a>
      </div>
    </div>
  </section>

  <!-- Locations Section -->
  <LocationsSection lang={lang} />

</Layout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const timelineSection = document.querySelector('.timeline-section');
    const timelineTrack = document.querySelector('.timeline-track');

    if (!timelineSection || !timelineTrack) return;

    // Calculate dimensions
    const updateTimeline = () => {
      const trackWidth = timelineTrack.scrollWidth;
      const viewportWidth = window.innerWidth;
      // Extra padding to ensure last item is fully visible
      const extraPadding = 300;
      const scrollDistance = trackWidth - viewportWidth + extraPadding;

      // Set section height based on scroll distance needed
      const sectionHeight = Math.max(scrollDistance + window.innerHeight, window.innerHeight);
      timelineSection.style.height = `${sectionHeight}px`;
    };

    const handleScroll = () => {
      const rect = timelineSection.getBoundingClientRect();
      const stickyContainer = document.querySelector('.timeline-sticky-container');

      if (!stickyContainer) return;

      const sectionTop = rect.top;
      const sectionHeight = timelineSection.offsetHeight;
      const viewportHeight = window.innerHeight;

      // Calculate scroll progress within the section
      const scrollProgress = Math.max(0, Math.min(1, -sectionTop / (sectionHeight - viewportHeight)));

      // Calculate horizontal translation - ensure last item is fully visible
      const trackWidth = timelineTrack.scrollWidth;
      const viewportWidth = window.innerWidth;
      const maxTranslate = trackWidth - viewportWidth + 250;
      const translateX = scrollProgress * maxTranslate;

      // Apply transform
      timelineTrack.style.transform = `translateX(-${translateX}px)`;
    };

    // Initial setup
    updateTimeline();

    // Event listeners
    window.addEventListener('scroll', handleScroll, { passive: true });
    window.addEventListener('resize', () => {
      updateTimeline();
      handleScroll();
    });

    // Initial call
    handleScroll();
  });
</script>

<style>
  .timeline-section {
    position: relative;
  }

  .timeline-sticky-container {
    position: sticky;
    top: 0;
    height: 100vh;
    display: flex;
    align-items: center;
    overflow: hidden;
  }

  .timeline-track {
    transition: transform 0.1s ease-out;
    will-change: transform;
  }

  .timeline-item {
    opacity: 1;
  }
</style>
